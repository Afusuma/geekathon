# Story 1.1: The "Steel Thread" - Infrastructure & Connectivity

## Status
Draft

## Story
**As a** developer,
**I want** a configured monorepo with a "hello-world" Lambda endpoint and a minimal React app that can successfully call it,
**so that** the core end-to-end architecture is proven and de-risked.

## Acceptance Criteria
1. **AC1**: A functional Turborepo monorepo is initialized with the correct structure and configuration
2. **AC2**: A minimal Next.js application can be started locally using `pnpm dev`
3. **AC3**: A "hello-world" AWS Lambda function is implemented and can be invoked locally using SAM CLI
4. **AC4**: The React app can successfully make an API call to the Lambda function and display the response
5. **AC5**: Both frontend and backend have TypeScript configured with shared types from `@smartlabel/shared` package
6. **AC6**: Basic project documentation (README.md) with setup instructions is created

## Tasks / Subtasks

- [ ] **Task 1: Initialize Turborepo Monorepo Structure** (AC: 1, 5)
  - [ ] Initialize Turborepo with `npx create-turbo@latest`
  - [ ] Configure `turbo.json` for monorepo build orchestration
  - [ ] Set up `pnpm` as package manager (v8.x)
  - [ ] Create workspace structure: `apps/`, `packages/`
  - [ ] Initialize `packages/shared` for TypeScript types
  - [ ] Initialize `packages/config` for shared configurations

- [ ] **Task 2: Set Up Next.js Frontend Application** (AC: 2, 4, 5)
  - [ ] Create `apps/web` Next.js application (v14.x)
  - [ ] Configure TypeScript (v5.x)
  - [ ] Install and configure Tailwind CSS (v3.x)
  - [ ] Install `shadcn/ui` components
  - [ ] Install TanStack Query (v5) for data fetching
  - [ ] Create basic layout and hello-world page
  - [ ] Implement API call to backend with TanStack Query

- [ ] **Task 3: Set Up AWS SAM Backend Application** (AC: 3, 5)
  - [ ] Create `apps/api` directory structure
  - [ ] Initialize AWS SAM with `template.yaml`
  - [ ] Create `src/handlers/hello.ts` Lambda function
  - [ ] Configure TypeScript for Lambda (Node.js 20.x LTS)
  - [ ] Install Zod for schema validation
  - [ ] Implement hello-world endpoint returning JSON response
  - [ ] Configure local development with `sam local start-api`

- [ ] **Task 4: Configure Shared Types Package** (AC: 5)
  - [ ] Create `packages/shared/types/` directory
  - [ ] Define basic API response interfaces
  - [ ] Export types for frontend and backend consumption
  - [ ] Configure TypeScript path mapping

- [ ] **Task 5: Implement End-to-End Connectivity** (AC: 4)
  - [ ] Configure API Gateway local endpoint
  - [ ] Implement CORS headers for local development
  - [ ] Create API client in frontend using TanStack Query
  - [ ] Implement error handling for API calls
  - [ ] Test successful request/response cycle

- [ ] **Task 6: Documentation and Project Setup** (AC: 6)
  - [ ] Create comprehensive README.md with setup instructions
  - [ ] Document local development workflow
  - [ ] Add scripts to root package.json for development
  - [ ] Create developer onboarding guide

## Dev Notes

### Previous Story Insights
This is the first story in the project - no previous story context available.

### Tech Stack Requirements
[Source: architecture/tech-stack.md]
- **Monorepo Tool**: Turborepo (Latest) - High-speed builds and caching
- **Package Manager**: pnpm (8.x) - Fast and disk-efficient
- **Frontend Framework**: Next.js (14.x) - Production-ready React environment
- **Frontend Language**: TypeScript (5.x) - Type safety across stack
- **Backend Runtime**: Node.js (20.x LTS) - Stable Lambda runtime
- **Backend Language**: TypeScript (5.x) - Shared types with frontend
- **IaC & Deploy**: AWS SAM CLI (Latest) - Serverless resource management
- **Data Fetching**: TanStack Query (v5) - Industry standard for React data fetching
- **Styling**: Tailwind CSS (3.x) - Utility-first CSS framework
- **UI Components**: shadcn/ui (Latest) - Accessible components
- **Schema Validation**: Zod (Latest) - TypeScript-first validation

### Project Structure Requirements
[Source: architecture/source-tree.md]
```
smartlabel-ai/
├── apps/
│   ├── api/                  # AWS SAM Serverless Application
│   │   ├── src/
│   │   │   └── handlers/
│   │   │       └── hello.ts  # Initial hello-world endpoint
│   │   └── template.yaml     # IaC definition
│   └── web/                  # Next.js Frontend Application
│       ├── src/
│       │   └── app/
│       └── ...
├── packages/
│   ├── shared/               # Shared TypeScript types
│   ├── ui/                   # Shared React component library
│   └── config/               # Shared configurations (ESLint, etc.)
├── package.json
└── turbo.json
```

### File Locations
- **Root monorepo**: `./` (current directory)
- **Frontend app**: `apps/web/`
- **Backend API**: `apps/api/`
- **Shared types**: `packages/shared/`
- **Hello endpoint**: `apps/api/src/handlers/hello.ts`
- **Main page**: `apps/web/src/app/page.tsx`

### Coding Standards
[Source: architecture/coding-standards.md]
- **Use `@smartlabel/shared` package for types**
- **TanStack Query for data fetching**
- **Components**: PascalCase naming
- **API routes**: kebab-case naming
- **Proper error boundaries for React components**
- **Validate all inputs with Zod schemas**
- **Use Tailwind CSS for styling consistency**

### API Standards
[Source: architecture/coding-standards.md]
- Validate all inputs with Zod schemas
- Use proper HTTP status codes
- Implement consistent error handling
- Follow REST conventions
- CORS configuration for local development

### Security Standards
[Source: architecture/coding-standards.md]
- Never expose sensitive data in client code
- Use proper IAM roles with least privilege
- Implement rate limiting on API endpoints

## Testing

### Testing Standards
[Source: architecture/tech-stack.md]
- **Frontend Testing**: Jest & RTL (Latest) - Standard Next.js testing suite
- **E2E Testing**: Playwright (Latest) - Browser automation for critical paths
- **Unit Tests**: Form the base of testing pyramid
- **Integration Tests**: Verify backend logic with dependencies

### Test Requirements for This Story
- Unit tests for hello-world Lambda function
- Basic frontend component tests for API integration
- Integration test for end-to-end API connectivity
- Tests must be written using Jest and React Testing Library

### Test File Locations
- Frontend tests: `apps/web/src/__tests__/` or co-located with components
- Backend tests: `apps/api/src/__tests__/` or co-located with handlers
- Integration tests: `apps/api/tests/integration/`

## Change Log

| Date | Version | Description | Author |
| :--- | :--- | :--- | :--- |
| Sep 17, 2025 | 1.0 | Initial story draft for Steel Thread implementation | Bob, SM |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
*TBD by dev agent*

### Debug Log References
*TBD by dev agent*

### Completion Notes List
*TBD by dev agent*

### File List
*TBD by dev agent*

## QA Results
*Results from QA Agent review will be added here after story completion*